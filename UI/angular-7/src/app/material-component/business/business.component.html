<div fxLayout="row"  >

        
            <br>
            <mat-card >
                 <mat-card-content > 
                      <mat-card-title>Business View </mat-card-title>
                      <br>
                      <mat-form-field [formGroup]="business_data">
                          <mat-label>Select the business</mat-label>
                          <mat-select [(ngModel)]="b_name" name="business" formControlName="b_name" (click)="selectBusiness()"  >
                              <mat-option *ngFor="let business of businesses" [value]="business.value" >
                              {{business.value}}
                              </mat-option>
                          </mat-select>
                      </mat-form-field>
                      
                </mat-card-content>
                
            
            <div fxLayout="row"  fxLayoutGap="12px"  [style.margin-top]="'12px'" >
                <div fxLayout="column" >
                    <mat-card class="example-card card" style="width: 820px;height: 50% ">
                        <mat-card-content>
                            <mat-card-title>
                                AVAERAGE CUSTOMER SATISFACTION         
                            </mat-card-title>
                            <br>
                            <mat-progress-bar mode="determinate" [value]="satisfactionAvg"
                            style="height:80px"></mat-progress-bar> 
                            <div > {{satisfactionAvg}}%</div>
                        </mat-card-content>
                    </mat-card>
                    <mat-card class="example-card card" style="width: 820px;height: 50% ">
                            <mat-card-content>
                                <mat-card-title>
                                    OVERALL CUSTOMER SATISFACTION         
                                </mat-card-title>
                                <br>
                                <mat-progress-bar mode="determinate" [value]="satisfaction"
                                style="height:80px"></mat-progress-bar> 
                                <div > {{satisfaction}}% </div>
                            </mat-card-content>
                        </mat-card>
                    
                        <mat-card class=" card text-center" style="width:820px;height:40%;" >
                            <mat-card-content >
                                <button mat-button (click)="getAllReviews()" class=" card  bg-warning col-5 " style="height:60px;border-radius:20px;margin:10px" >All Reviews</button>
                                
                                <button mat-button (click)="getAllPositive()" class=" card text-white bg-success col-5" style="height:60px;border-radius:20px;margin:10px">Merits</button>
                                <br>
                                <button mat-button (click)="getAllNegative()" class=" card text-white bg-danger col-5" style="height:60px;border-radius:20px;margin:10px">Concerns</button>
                                <button mat-button (click)="getTopFivePosNeg()" class=" card text-white bg-primary col-5" style="height:60px;border-radius:20px;margin:10px">Top Highlights and Issues</button>
                            
                            </mat-card-content>
                            
                        </mat-card>
                    <div fxLayout="row" fxLayoutGap="12px"  [style.margin-left]="'13px'" [style.margin-top]="'12px'" [style.width]="'820px'" >
                        <mat-expansion-panel (opened)="panelOpenState = false" (closed)="panelOpenState = true" class="example-card card text-white bg-primary" style="width:100%;"
                            align-content="center">
                            <br>
                            <br>
                            <mat-expansion-panel-header >
                                <mat-panel-title>Highlights for a given Time Frame
                                </mat-panel-title>
                        
                            </mat-expansion-panel-header>
                        
                            <mat-form-field [formGroup]="keyword_pos_data">
                                <mat-label>Select the time frame</mat-label>
                                <mat-select [(ngModel)]="timepos" name="time_frame" formControlName="tframe_pos"  >
                                    <mat-option *ngFor="let time of time_frame" [value]="time.value" (click)="selectPosTimeFrame(time.value)">
                                        {{time.value}}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                            <p style="white-space: pre-wrap;">{{allKeywordsPos}}</p>
                        </mat-expansion-panel>
                    
                        <mat-expansion-panel (opened)="panelOpenState = false" (closed)="panelOpenState = true" class="example-card  card text-white bg-success" style="width:100%;"
                            align-content="center">
                            <br>
                            <br>
                            <mat-expansion-panel-header >
                                <mat-panel-title>Issues for a given Time Frame
                                </mat-panel-title>
                        
                            </mat-expansion-panel-header>
                    
                            <mat-form-field [formGroup]="keyword_neg_data">
                                <mat-label>Select the time frame</mat-label>
                                <mat-select [(ngModel)]="timeneg" name="time_frame" formControlName="tframe_neg" >
                                    <mat-option *ngFor="let time of time_frame" [value]="time.value" (click)="selectNegTimeFrame(time.value)">
                                        {{time.value}}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                            <p style="white-space: pre-wrap;">{{allKeywordsNeg}}</p>
                        
                        </mat-expansion-panel>
                                
                       
                        
                        
                    </div>

                </div>
                
                <mat-card class="card "  >
                    <mat-card-content>
                        <mat-card-title>
                            Graph of all Reviews over time
                        </mat-card-title>
                        <br>
                        <google-chart #chart
                        [title]="title"
                        [type]="type"
                        [data]="data"
                        [columnNames]="columnNames"
                        [options]="options"
                        [width]="width"
                        [height]="height">
                        </google-chart>
                                            
                    </mat-card-content>
                </mat-card>
            </div>
            
            <div fxLayout="row"  fxLayoutGap="12px"  [style.margin-top]="'12px'" [style.margin-right]="'12px'" [style.margin-left]="'12px'">  
            <mat-expansion-panel (opened)="panelOpenState = false" (closed)="panelOpenState = true" class="example-card  card text-white bg-danger " style="width:800px;margin-left:10px;margin-top:10px;margin-bottom:10px"
                align-content="center">
            
                <br>
                <br>
                <mat-expansion-panel-header >
                    <mat-panel-title>Most Recent Positive Reviews</mat-panel-title>
            
                </mat-expansion-panel-header>
                <div *ngFor="let item of positiveReviews" class="card-deck">
                    <mat-card class="example-card " style="width:100%">
                        <mat-card-header>
                    
                          <div mat-card-avatar class="example-header-image" style="background-image: url('{{item.logo}}')"></div>
                          <mat-card-title>{{item.username}}</mat-card-title>
                          <mat-card-subtitle>Rating: {{item.rating}}</mat-card-subtitle>
                        </mat-card-header>
                        <mat-card-content>
                            <p style="white-space: pre-wrap;">{{item.review}}</p>
                        </mat-card-content>
                        
                    </mat-card>
                </div>
            </mat-expansion-panel>



            <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false" class="example-card  card text-white bg-warning " style="width:800px;"
                align-content="center">
                <br>
                <br>
                <mat-expansion-panel-header >
                    <mat-panel-title>Most Recent Negative Reviews</mat-panel-title>
                </mat-expansion-panel-header>
            
                <div *ngFor="let item of negativeReviews" > 
                <mat-card class="example-card " style="width:100%">
                    <mat-card-header>
                        <div mat-card-avatar class="example-header-image" ></div>
                        <mat-card-title>{{item.username}}</mat-card-title>
                        <mat-card-subtitle>Rating: {{item.rating}}</mat-card-subtitle>
                    </mat-card-header>
                    <mat-card-content>
                        <p style="white-space: pre-wrap;">{{item.review}}</p>
                    </mat-card-content>
                    
                </mat-card>
                </div>
            </mat-expansion-panel>
        </div>
        
        <div fxLayout="row" >
            <mat-card class="example-card card" style="width: 1200px;">
                <mat-card-header>
                    <mat-card-title>WHAT DO YOUR CUSTOMERS THINK ABOUT YOU?</mat-card-title>
                </mat-card-header>
                <mat-card-content>
                       
                    <!-- <div AgWordCloud 
                    #word_cloud_chart=ag-word-cloud 
                    [wordData]="wordDataPos"
                    [options]="options">
                    </div> -->
                    <div>
                        <angular-tag-cloud
                            [data]="wordDataPos"
                            [width]="optionsCloud.width"
                            [height]="optionsCloud.height"
                            [overflow]="optionsCloud.overflow">
                        </angular-tag-cloud>
                    </div>
                </mat-card-content>
                
            </mat-card>

            <mat-card style="width:400px;color:#ffffff" class="example-card card bg-primary">
                <mat-card-header>
                    <mat-card-title>SUMMARY</mat-card-title>
                </mat-card-header>
                <mat-card-content>
                    <div>
                        {{summary}}
                    </div>
                </mat-card-content>
            </mat-card>
            </div>
            <mat-card  class="example-card card  bg-warning  " >
                <mat-card-header>
                    <mat-card-title>SELECT DATES TO SEE REVIEWS IN THE FOLLOWING PERIOD</mat-card-title>
                </mat-card-header>
                <mat-card-content>

                    <div [formGroup]="date_data" class="example-full-width">
                        <mat-form-field class="col-3">
                            <input matInput [matDatepicker]="picker1" [min]="minDate1" [max]="maxDate1" 
                            placeholder="Select a Date" [formControl]="date1" (dateInput)="getDate('date1', $event)" readonly>
                            <mat-datepicker-toggle matSuffix [for]="picker1" ></mat-datepicker-toggle>
                            <mat-datepicker #picker1></mat-datepicker>
                        </mat-form-field>
                                
                        <mat-form-field class="col-3">
                            <input matInput [matDatepicker]="picker2" placeholder="Select a Date"
                                    [formControl]="date2" [min]="minDate2" [max]="maxDate2" (dateInput)="getDate('date2', $event)" readonly>
                            <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                            <mat-datepicker #picker2></mat-datepicker>
                        </mat-form-field>
                        
                        <button mat-button (click)="getAllReviewsIntervals()" class=" card form-control col-1 " style="height:60px;border-radius:20px;">View Reviews</button>
                        
                                
                    </div>
                    <div *ngFor="let item of reviewInterval" > 
                            <mat-card class="example-card " style="width:100%;margin-right:24px">
                                <mat-card-header>
                                    <div mat-card-avatar class="example-header-image" ></div>
                                    <mat-card-title>{{item.username}}</mat-card-title>
                                    
                                </mat-card-header>
                                <mat-card-content>
                                    <p style="white-space: pre-wrap;">{{item.review}}</p>
                                </mat-card-content>
                                
                            </mat-card>
                    </div>
                    
                </mat-card-content>
            </mat-card>
           
            
            <mat-card class="card "  >
                <mat-card-content>
                    <mat-card-title>
                        TRENDS OBSERVED
                    </mat-card-title>
                    <br>
                   
                    <google-chart #chart
                    [title]="titleHist"
                    [type]="typeHist"
                    [data]="dataHist"
                    [columnNames]="columnNamesHist"
                    [options]="optionsHist"
                    [width]="widthHist"
                    [height]="heightHist">
                    </google-chart>
                    
                               
                </mat-card-content>
            </mat-card>
            <mat-card class="card " style="height:500px" >
                    <mat-card-content>
                        <mat-card-title>
                            MEET YOUR FOCUS POINTS
                        </mat-card-title>
                        <br>
                        <div fxLayout="row">
                            <mat-card class="card " style="width:700px;overflow-y:auto;height:350px;">
                            <div *ngFor="let keyword of dataItems" style="text-align:center;font-size:24px">
                                <button   (click)="getSatisfaction(keyword)" style="margin-bottom:10px;border-radius: 20px">{{keyword}}</button>
                            </div>
                            </mat-card>
                            <div >
                                <div style="margin:90px;height:350px;" fxLayout="row" >
                                    <mat-progress-bar class="progress vertical progress-bar-success bg-success" mode="determinate" [value]="satisfactionKeyword" [color]="accent"
                                        style="height:200px;width:350px;"></mat-progress-bar> 
                                    <div > {{satisfactionKeyword}}% liked this attribute</div>
                                </div>
                            </div>
                        </div>                  
                    </mat-card-content>
                </mat-card> 
                

        </mat-card>
</div>
      
      